# 🏰 Pet Trainer 대탐험: 초보자를 위한 상세 가이드

환영합니다! 개발이 처음이라도 걱정 마세요.
이 프로젝트가 거대한 **"레스토랑"**이라고 상상하고 하나씩 설명해 드릴게요.

---

## 1. 기본 개념 (용어 설명) 🍳

### 프론트엔드 (Frontend) = 손님 테이블 (Dining Area)
*   **역할**: 사용자가 직접 보고 만지는 **화면(UI)**입니다.
*   **우리 프로젝트**: **Flutter (앱)**.
*   **비유**: 손님이 메뉴판(화면)을 보고 주문 벨(버튼)을 누르는 곳입니다. 요리를 직접 하지는 않아요. 예쁘게 보여주는 것이 주 업무입니다.

### 백엔드 (Backend) = 주방 (Kitchen)
*   **역할**: 눈에 보이지 않는 곳에서 실제 일처리를 하는 **서버**입니다.
*   **우리 프로젝트**: **Python FastAPI (서버)**.
*   **비유**: 주문이 들어오면 요리사들이 지지고 볶아서(로직 처리) 완성된 요리(데이터)를 내보내는 곳입니다.

### API & 라우터 (Router) = 웨이터 (Waiter)
*   **역할**: 프론트엔드(테이블)와 백엔드(주방) 사이를 오가며 주문을 전달합니다.
*   **비유**:
    *   **Router**: "이 주문은 파스타니까 파스타 담당 요리사에게 줘야지"라고 분류해주는 웨이터장입니다.
    *   **Request/Response**: "스테이크 하나 주세요"(Request) -> "여기 스테이크 나왔습니다"(Response).

### 데이터베이스 (DB) = 대형 냉장고 (Pantry) 🐘
*   **역할**: 데이터를 영구적으로 저장하는 창고입니다.
*   **우리 프로젝트**: **PostgreSQL** (Docker로 실행됨).
*   **비유**: 요리(서버)가 끝나도 재료(유저 정보, 레벨)가 상하지 않게 보관해두는 곳입니다. 앱을 껐다 켜도 레벨이 유지되는 이유죠.

### 웹소켓 (WebSocket) = 주방 직통 무전기 (Intercom) 📡
*   **역할**: 웨이터를 거치지 않고 실시간으로 정보를 주고받는 빨대 같은 연결선입니다.
*   **비유**: 일반 주문(API)은 웨이터가 왔다 갔다 해야 하지만, 웹소켓은 손님과 요리사가 **무전기**를 들고 "지금 소금 더!" "오케이!" 하고 0.1초 만에 대화하는 것과 같아요. 운동이나 전투처럼 빠른 반응이 필요할 때 씁니다.

### AI (YOLO/LLM) = 특급 수석 셰프 (Master Chef) 👨‍🍳
*   **역할**: 단순한 계산이 아니라, 이미지를 보고 판단하거나 말을 지어내는 지능적인 일을 합니다.
*   **비유**: 일반 요리사가 레시피대로만 한다면, 이 셰프는 "이 재료 상태를 보니 이게 좋겠군" 하고 판단(Inference)을 내립니다.

### 엣지 AI (Edge AI) = 푸드트럭 / 도시락 🍱
*   **역할**: 인터넷이 끊겨도 내 폰 안에서 작동하는 작은 셰프입니다.
*   **비유**:
    *   본점 주방(서버)까지 가기 귀찮을 때, 내 폰 안(푸드트럭)에서 간단한 요리(기본 훈련 판정)를 즉석에서 해치웁니다.
    *   훨씬 빠르지만, 본점만큼 엄청나게 복잡한 요리는 못 할 수도 있습니다.

### 배틀장 (Battle Arena) = 팔씨름 전용 테이블 💪
*   **역할**: 다른 손님(유저)과 내 펫의 힘을 겨루는 곳입니다.
*   **비유**: 일반 식사 테이블이 아니라, 승패를 가리기 위해 특별히 마련된 구역입니다. 요리사(서버)가 심판을 봐주고, 승리하면 특별한 디저트(보상)를 줍니다.

### 미니홈피 (Mini-Homepage) = 벽면 게시판 / 방명록 📌
*   **역할**: 내 펫의 사진(베스트 샷)을 붙여놓고 자랑하거나, 친구가 메모를 남기는 곳입니다.
*   **비유**:
    *   **자동 추억 (AI Synergy)**: 사진작가(Vision)가 몰래 찍은 멋진 사진에, 시인(LLM)이 멋진 문구를 써서 자동으로 게시판에 붙여줍니다. 나는 놀았을 뿐인데 게시판이 꽉 차 있어요!

---

## 2. 프로젝트 구조 (지도) 🗺️

이 지도를 보고 "아, 여기가 냉장고구나", "여기가 파스타 코너구나" 하고 찾아가시면 됩니다.

### 📱 `frontend/lib/` (손님 테이블 구역)
*   **`main.dart`**: 식당 정문. 앱이 시작되는 곳입니다.
*   **`screens/`**: 각 테이블의 테마.
    *   `menu_page.dart`: 로비 (대기실).
    *   `my_room_page.dart`: 내 방 (휴식실).
    *   `battle_page.dart`: 경기장 (게임 테이블).
*   **`providers/`**: 주문용 태블릿. 버튼을 누르면 서버에 요청을 보내는 로직이 들어 있습니다.
    *   `training_controller.dart`: "운동 시작!" 버튼을 담당. (서버 모드/엣지 모드 선택 가능)
    *   **`edge_ai/`**: 푸드트럭 식자재 창고. `flutter_tflite`가 사용하는 모델 파일(.tflite)이 있습니다.

### ⚙️ `backend/app/` (주방 구역)
*   **`main.py`**: 주방 총괄 매니저. 모든 요청을 1차적으로 받아 각 파트로 분배합니다.
*   **`api/` (웨이터 대기실)**:
    *   `endpoints/users.py`: 회원가입/로그인 담당 웨이터.
    *   `endpoints/character.py`: 캐릭터 정보 담당 웨이터.
*   **`sockets/` (무전기 센터)**:
    *   `socket_service.py`: "지금 강아지가 장난감을 물었나요?" 실시간 영상 분석 담당.
    *   `battle_socket.py`: "상대방 때렸어요!" 실시간 전투 담당.
*   **`ai_core/` (특급 셰프실)**:
    *   `vision/detector.py`: 눈썰미 좋은 셰프(YOLO). 사진을 보고 "강아지네!", "장난감이네!" 알아맞힙니다.
    *   `brain/graphs.py`: 말 잘하는 셰프(LLM). "주인님 칭찬해 주세요!" 같은 대사를 만듭니다.
*   **`db/` (냉장고 관리소)**:
    *   `crud.py`: 냉장고에서 재료를 꺼내고(Read) 넣는(Create/Update) 일을 합니다.

---

## 3. 동작 시나리오 (실전 예시) 🎬

### 🎬 시나리오 1: "강아지가 공을 물었어요!" (훈련 모드)

1.  **[Frontend]** 앱에서 카메라를 켭니다. (손님이 "요리 시작!" 외침)
2.  **[WebSocket]** 카메라 영상이 0.1초마다 **무전기**를 타고 주방(`sockets`)으로 날아갑니다.
3.  **[AI Vision]** **특급 셰프(YOLO)**가 영상을 봅니다.
    *   "음, 강아지(Pet)가 있고... 공(Toy)이 있군. 거리가 아주 가깝네(Distance<20cm)?"
4.  **[Logic]** 셰프가 판단을 내립니다. "이건 '공 물어오기' 성공이다!"
5.  **[AI Brain]** **말주변 좋은 셰프(LLM)**에게 마이크를 넘깁니다. "성공 멘트 하나 멋지게 뽑아줘."
    *   "오구오구 잘한다 내 새끼! (Strength +1)"
6.  **[WebSocket]** 이 멘트와 점수가 다시 **무전기**를 타고 앱으로 즉시 전송됩니다.
7.  **[Frontend]** 화면에 "성공!" 폭죽이 터집니다.
+
+> **🍱 만약 엣지(Edge) 모드라면?**
+> *   무전기(WebSocket)를 안 씁니다!
+> *   **[App]** -> **[TFLite (내장 셰프)]** -> **[성공 판정]** -> **[App]**
+> *   주방에 다녀올 필요가 없어서 반응이 엄청 빠릅니다.

---

### 🎬 시나리오 2: "내 방에서 스탯 확인하기" (일반 모드)

1.  **[Frontend]** `MyRoomPage`에 들어갑니다. (손님이 "내 정보 보여줘" 주문)
2.  **[API]** **웨이터**(`endpoints/character.py`)가 주문을 받아 주방으로 갑니다.
3.  **[DB]** 요리사가 **냉장고(`crud.py`)** 문을 엽니다.
    *   "User 1번의 힘(Strength) 스탯 좀 꺼내줘."
4.  **[Response]** 웨이터가 숫자가 적힌 접시를 들고 테이블로 돌아옵니다.
5.  **[Frontend]** 화면의 스탯 막대그래프가 쭉 올라갑니다.

---

### 📝 요약: 무엇을 수정하고 싶나요?

*   **"화면 디자인이 구려요!"** 👉 **프론트엔드(`frontend/lib/screens/`)**로 가세요.
*   **"운동 인식이 너무 잘 안 돼요!"** 👉 **특급 셰프(`ai_core/vision/detector.py`)**에게 가서 안경(임계값 설정)을 고쳐주세요.
*   **"캐릭터가 좀 더 다정하게 말했으면 좋겠어요."** 👉 **말 잘하는 셰프(`ai_core/brain/prompts.py`)**의 대본을 수정하세요.
*   **"저장이 안 돼요!"** 👉 **냉장고(`db/`)**나 **웨이터(`api/`)** 쪽을 점검하세요.

이제 이 복잡해 보이는 코드가 조금 친숙해지셨나요? 즐거운 코딩 되세요! 👨‍💻👩‍💻
